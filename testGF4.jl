using Nemo

include("GF4WeightsGPU.jl")
using .GF4WeightsGPU

const F, a = finite_field(4, "a")

G6_4 = matrix(F, [
    [1,0,0,1,a^2,a^2],
    [0,1,0,a^2,a^2,1],
    [0,0,1,a^2,1,a^2]
])

G8_4 = matrix(F, [
    [1,0,0,0,1,1,0,1],
    [0,1,0,0,0,1,1,1],
    [0,0,1,0,1,1,1,0],
    [0,0,0,1,1,0,1,1]
])

G24_4 = matrix(F, [
    [1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,1,1,0,0,0,1,1],
    [0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,0,1,0],
    [0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,1,0,1,0,1,1],
    [0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,1,0,1,1,0],
    [0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,0,0,1],
    [0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,0,1],
    [0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,1,1,0,1,1,1],
    [0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,0,1,1,1,1,0,0,0],
    [0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,0,1,1,1,1,0,0],
    [0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,1,1,0,1,1,1,1,0],
    [0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,1,1,0,0,0,1,1,0,1],
    [0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,1,1,0,0,0,1,1,1]
])

G30_4 = matrix(F, [
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,a,0,a,a^2,1,a^2,a,a^2,1,a^2,a,0,a,a],
    [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,a,a,a,a^2,a^2,1,0,0,a^2,1,0,0,a,a^2,1],
    [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,a^2,a^2,a,a^2,1,0,a^2,1,a,0,a^2,1,0,a^2,0],
    [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,a^2,a,a^2,a^2,1,a,a,a,a^2,1,a,a,1,1,1],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,a,1,0,0,1,0,1,a,a,0,a,a^2,a^2],
    [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a^2,0,1,a^2,a^2,a^2,a,0,a,a,0,a^2,0,a^2,a],
    [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,a^2,a,0,0,1,0,1,a^2,a,1,0,1,a^2,1,a^2],
    [0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,a,a,a^2,0,a^2,a^2,0,a^2,a,a,1,1,1],
    [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,a^2,1,0,1,a,a^2,1,0,1,0,0,a,a^2,a^2],
    [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,a^2,0,a^2,0,a,a,0,a,a^2,a^2,a^2,1,0,a^2,a],
    [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,a^2,a,0,a,a,1,0,1,0,0,1,a,1,1,a^2],
    [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,a,a,1,a^2,a,a,a,1,a^2,a^2,a,a^2,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,a^2,0,1,a^2,0,a,1,a^2,0,1,a^2,a,a^2,a^2,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,a^2,a,0,0,1,a^2,0,0,1,a^2,a^2,a,a,a,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,a,0,a,a^2,1,a^2,a,a^2,1,a^2,a,0,a,1,a]
])

wd6 = partialweightdistribution(G6_4, 6)
println("Weight distribution of [6,3]_9 code")
for w ∈ 0:6
    println("w=$w: ", wd6[w+1])
end

wd12 = partialweightdistribution(G8_4, 12)
println("Weight distribution of [12,6]_9 code")
for w ∈ 0:8
    println("w=$w: ", wd12[w+1])
end

wd24 = partialweightdistribution(G24_4, 16)
println("Partial weight distribution of [24,12]_9 code")
for w ∈ 0:16
    println("w=$w: ", wd24[w+1])
end

wd30 = partialweightdistribution(G30_4, 16)
println("Partial weight distribution of [30,15]_9 code")
for w ∈ 0:16
    println("w=$w: ", wd30[w+1])
end