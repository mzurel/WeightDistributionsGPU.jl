using Nemo

include("GF9WeightsGPU.jl")
using .GF9WeightsGPU

const F, a = finite_field(9, "a")

G6_9 = matrix(F, [
    [1,0,0,1,a,a^3],
    [0,1,0,a^5,a^5,a^6],
    [0,0,1,a,1,a^3]
])

G12_9 = matrix(F, [
    [1,0,0,0,0,0,2,2,1,2,0,1],
    [0,1,0,0,0,0,0,2,2,1,2,1],
    [0,0,1,0,0,0,2,2,0,1,1,2],
    [0,0,0,1,0,0,1,0,1,1,1,1],
    [0,0,0,0,1,0,1,2,2,2,1,0],
    [0,0,0,0,0,1,1,2,1,0,2,2]
])

G24_9 = matrix(F, [
    [1,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,0,1,0,2,2,1,1,1],
    [0,1,0,0,0,0,0,0,0,0,0,0,1,2,0,2,1,2,1,1,0,1,0,0],
    [0,0,1,0,0,0,0,0,0,0,0,0,0,1,2,0,2,1,2,1,1,0,1,0],
    [0,0,0,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1,0,2,0,2,2],
    [0,0,0,0,1,0,0,0,0,0,0,0,2,1,0,2,1,1,1,0,2,0,1,0],
    [0,0,0,0,0,1,0,0,0,0,0,0,1,2,1,2,2,0,1,2,1,1,2,2],
    [0,0,0,0,0,0,1,0,0,0,0,0,2,1,2,2,2,0,0,0,1,2,2,0],
    [0,0,0,0,0,0,0,1,0,0,0,0,2,2,1,0,2,0,0,2,2,2,0,1],
    [0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,1,0,2,0,0,2,2,2,1],
    [0,0,0,0,0,0,0,0,0,1,0,0,2,0,2,0,1,1,2,2,2,0,0,2],
    [0,0,0,0,0,0,0,0,0,0,1,0,0,2,0,2,0,1,1,2,2,2,0,2],
    [0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,0,2,0,1,1,2,2,2,2],
])

G30_9 = matrix(F, [
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,a^3,1,a^6,a,2,a^6,a^6,a^6,2,a,a^6,1,a^3,a^3],
    [0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,a^7,a^7,0,a^3,a^5,1,a^6,a^7,a^7,a,0,0,1,a^7,2],
    [0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,a^3,1,0,a,a^5,2,a^2,2,a^6,a^3,a^7,a,a^3,a^5,a^3],
    [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,a,a^5,a^2,a^7,a^3,a,a^2,a^5,a^2,a^7,2,a^3,a^5,a^5,a^5],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,a,a^7,0,a^5,a^5,a^2,a^6,a^5,2,1,a^5,a^2,1,a^6,a^6],
    [0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a^2,0,a^5,1,a^2,a^7,a^7,a^5,a^3,a^3,a^6,a^3,a^6,a^3,a^7],
    [0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,a^7,a^6,a^7,a,2,2,2,2,a,a^7,a^6,a^7,0,0,a^5],
    [0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,a^7,a^6,a^7,a,2,2,2,2,a,a^7,a^6,a^7,0,a^5],
    [0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,a^7,a^6,a^7,a,2,2,2,2,a,a^7,a^6,a^7,a^5],
    [0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,a^3,a^6,a^3,a^6,a^3,a^3,a^5,a^7,a^7,a^2,1,a^5,0,a^2,a^7],
    [0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,a^6,1,a^2,a^5,1,2,a^5,a^6,a^2,a^5,a^5,0,a^7,a,a^6],
    [0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,a^5,a^5,a^3,2,a^7,a^2,a^5,a^2,a,a^3,a^7,a^2,a^5,a,a^5],
    [0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,a^5,a^3,a,a^7,a^3,a^6,2,a^2,2,a^5,a,0,1,a^3,a^3],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,a^7,1,0,0,a,a^7,a^7,a^6,1,a^5,a^3,0,a^7,a^7,2],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,a^3,1,a^6,a,2,a^6,a^6,a^6,2,a,a^6,1,a^3,1,a^3]
])

wd6 = partialweightdistribution(G6_9, 6)
println("Weight distribution of [6,3]_9 code")
for w ∈ 0:6
    println("w=$w: ", wd6[w+1])
end

wd12 = partialweightdistribution(G12_9, 12)
println("Weight distribution of [12,6]_9 code")
for w ∈ 0:12
    println("w=$w: ", wd12[w+1])
end

wd24 = partialweightdistribution(G24_9, 16)
println("Partial weight distribution of [24,12]_9 code")
for w ∈ 0:16
    println("w=$w: ", wd24[w+1])
end

wd30 = partialweightdistribution(G30_9, 16)
println("Partial weight distribution of [30,15]_9 code")
for w ∈ 0:16
    println("w=$w: ", wd30[w+1])
end